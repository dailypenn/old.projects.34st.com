var filmTV = {
  type: "FeatureCollection",
  category: "filmTV",
  name: "Movie Theaters",
  color: "rgb(254, 240, 55)",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1477118,39.9492886]
      },
      properties: {
        title: "Ritz Theaters",
        category: "Movie Theaters",
        address:"400 Ranstead Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1647147,39.9484661]
      },
      properties: {
        title: "Bryn Mawr Film Institute",
        address:"824 Lancaster Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1745745,39.9515352]
      },
      properties: {
        title: "PFS Roxy",
        address:"2023 Sansom Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.164683,39.9508334]
      },
      properties: {
        title: "Prince Theater",
        address:"1412 Chestnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1969099,39.9552474]
      },
      properties: {
        title: "Lightbox",
        address:"3701 Chestnut Street",
        "marker-size": "large"
      }
    }

  ]
};

var liveTheater = {
  type: "FeatureCollection",
  category: "liveTheater",
  name: "Playhouses &amp; Theaters",
  color: "rgb(22, 138, 167)",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.155462, 39.948524]
      },
      properties: {
        title: "Walnut Street Theater",
        category: "Playhouses &amp; Theaters",
        address:"825 Walnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1439121,39.9512167]
      },
      properties: {
        title: "Arden Theater",
        address:"40 N 2nd Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.164683,39.9508334]
      },
      properties: {
        title: "Prince Theater",
        address:"1412 Chestnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1901731,40.0595323]
      },
      properties: {
        title: "Sedgwick Theater",
        address:"7137 Germantown Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1595544,39.948586]
      },
      properties: {
        title: "Forrest Theater",
        address:"1114 Walnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1728924,39.9128371]
      },
      properties: {
        title: "Kimmel Center",
        address:"3000 S Broad Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1654997,39.9448916]
      },
      properties: {
        title: "Suzanne Roberts",
        address:"480 S Broad Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1562659,39.9507382]
      },
      properties: {
        title: "Latern Theater Company",
        address:"923 Ludlow Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.2184178,39.9482006]
      },
      properties: {
        title: "Curio Theater Company",
        address:"4740 Baltimore Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1592124,39.9739977]
      },
      properties: {
        title: "New Freedom Theater",
        address:"1346 N Broad Street",
        "marker-size": "large"
      }
    }
  ]
};

var musicVenues = {
  type: "FeatureCollection",
  category: "musicVenues",
  name: "Music Venues",
  color: "rgb(8, 61, 102)",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.155349, 39.961406]
      },
      properties: {
        title: "Union Transfer",
        category: "Music Venues",
        address:"1026 Spring Garden Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1487463,39.941247]
      },
      properties: {
        title: "Theater of Living Arts",
        address:"334 South Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1850894,39.9522277]
      },
      properties: {
        title: "World Cafe Live",
        address:"3025 Walnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1850894,39.9522277]
      },
      properties: {
        title: "WXPN",
        address:"3025 Walnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.134266,39.9690922]
      },
      properties: {
        title: "Johnny Brenda's",
        address:"1201 Frankford Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1612188,39.9508251]
      },
      properties: {
        title: "First Unitarian Church",
        address:"1225 Chestnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1500189,39.9589273]
      },
      properties: {
        title: "Electric Factory",
        address:"421 N 7th Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1350602,39.9655615]
      },
      properties: {
        title: "Fillmore/The Foundry",
        address:"29 E Allen Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1665541,39.9368353]
      },
      properties: {
        title: "Boot & Saddle",
        address:"1131 S Broad Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1565271,39.9537058]
      },
      properties: {
        title: "Trocadero",
        address:"1003 Arch Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.2589325,39.9611539]
      },
      properties: {
        title: "Tower Theater",
        address:"S 69th Street and Ludlow Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1652089,39.948067]
      },
      properties: {
        title: "Academy of Music",
        address:"240 S Broad Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.160284,39.9698791]
      },
      properties: {
        title: "Metropolitan Opera House",
        address:"858 N Broad Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1359322,39.970248]
      },
      properties: {
        title: "Kung Fu Necktie",
        address:"1248 N Front Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.158843,39.9355766]
      },
      properties: {
        title: "Connie's Ric Rac",
        address:"1132 S 9th St",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1587131,39.9590346]
      },
      properties: {
        title: "Underground Arts",
        address:"1200 Callowhill Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1462118,39.9705922]
      },
      properties: {
        title: "Everybody Hits",
        address:"529 W Girard Avenue",
        "marker-size": "large"
      }
    }
  ]
};

var performanceVenues = {
  type: "FeatureCollection",
  category: "performanceVenues",
  name: "Performance Venues",
  color: "rgb(30, 30, 30)",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1746935, 39.9516589]
      },
      properties: {
        title: "The Victoria Freehouse",
        category: "Performance Venues",
        address:"2031 Sansom Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.145966, 39.9617946]
      },
      properties: {
        title: "Ruba Club",
        address:"416 Green Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1746935,39.9516589]
      },
      properties: {
        title: "Helium Club",
        address:"2031 Sansom Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1746707,39.9512829]
      },
      properties: {
        title: "The N Club",
        address:"2030 Sansom Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1746707,39.9512829]
      },
      properties: {
        title: "Philly Improv Theater",
        address:"2030 Sansom Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1969306,39.9602761]
      },
      properties: {
        title: "Green Haus",
        address:"38th Street and Lancaster Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1675459,39.9440623]
      },
      properties: {
        title: "Bob and Barb's",
        address:"1509 South Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.2261134,39.9553281]
      },
      properties: {
        title: "Urban Art Gallery",
        address:"262 S 52nd Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1658929,39.9480384]
      },
      properties: {
        title: "Haute Restauraunt and Lounge",
        address:"1420 Locust Street",
        "marker-size": "large"
      }
    }
  ]
};

var interactiveExperiences = {
  type: "FeatureCollection",
  category: "interactiveExperiences",
  name: "Weekend Plans",
  color: "rgb(76, 93, 99)",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1346806, 39.9649452]
      },
      properties: {
        title: "VR at Mad Rex",
        category: "Weekend Plans",
        address:"1000 Frankford Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1673521, 39.949485]
      },
      properties: {
        title: "Escape the Room",
        address:"1528 Walnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1723684,39.9386903]
      },
      properties: {
        title: "Bury the Hatchet",
        address:"1719 Washington Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1348407,39.9629582]
      },
      properties: {
        title: "Go Vertical Rock Climbing Gym",
        address:"950 N Penn Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1446532,39.9502633]
      },
      properties: {
        title: "Pinot Boutique",
        address:"227 Market Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1527801,39.942221]
      },
      properties: {
        title: "Painting with a Twist",
        address:"611 South Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.144425,39.9536146]
      },
      properties: {
        title: "Kaya Aerial Yoga",
        address:"225 Quarry Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1695169,39.9517032]
      },
      properties: {
        title: "Pole Haus",
        address:"1719 Chestnut Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1696549,39.9439936]
      },
      properties: {
        title: "Philly Dance Fitness",
        address:"1624 South Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.2151339,39.9813277]
      },
      properties: {
        title: "Shofuso Japanese Cultural Center",
        address:"Lansdowne Drive and Horticultural Drive",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.2161397,39.9325627]
      },
      properties: {
        title: "Bartram's Garden",
        address:"5400 Lindbergh Boulevard",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1677348,39.9567064]
      },
      properties: {
        title: "Aqua Vitae",
        address:"148 N 17th Street",
        "marker-size": "large"
      }
    }
  ]
};

var arts = {
  type: "FeatureCollection",
  category: "arts",
  name: "Museums &amp; Galleries",
  color: "rgb(87, 137, 67)",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1636616, 39.9552145]
      },
      properties: {
        title: "PAFA Musuem",
        category: "Museums &amp; Galleries",
        address:"118-128 Broad Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1644223, 40.0227443]
      },
      properties: {
        title: "Colored Girls Museum",
        address:"4613 Newhall Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1602156,39.9537173]
      },
      properties: {
        title: "Fabric Museum",
        address:"1214 Arch Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1811577,39.9658059]
      },
      properties: {
        title: "PMA",
        address:"2600 Benjamin Franklin Parkway",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1739579, 39.9619232]
      },
      properties: {
        title: "Rodin",
        address:"2151 Benjamin Franklin Parkway",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1725901,39.9605194]
      },
      properties: {
        title: "Barnes",
        address:"2025 Benjamin Franklin Parkway",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1574795, 39.9622322]
      },
      properties: {
        title: "PhilaMOCA",
        address:"531 N 12 Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.143895,39.955502]
      },
      properties: {
        title: "Painted Bride",
        address:"230 Vine Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1950918,39.9541187]
      },
      properties: {
        title: "ICA",
        address:"118 S 36th Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1734893,40.0348261]
      },
      properties: {
        title: "Woodmere Art Museum",
        address:"92021 Germantown Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1285563,39.9838344]
      },
      properties: {
        title: "Little Berlin",
        address:"2430 Coral Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1498523,39.9393004]
      },
      properties: {
        title: "Paradigm Gallery + Studio",
        address:"746 S 4th Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1404004,39.9732491]
      },
      properties: {
        title: "Indigo Arts Gallery",
        address:"1400 N American Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.164069,39.9480901]
      },
      properties: {
        title: "Mural Mile South",
        address:"South of Market Street to Lombard Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1577979,39.9566209]
      },
      properties: {
        title: "Mural Mile North",
        address:"North of Market Street into Old City, through Chinatown and around City Hall",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.2139657,39.957932]
      },
      properties: {
        title: "Love Letter Murals",
        address:"Market Street, from 45th-63rd Streets",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1592352,39.9426155]
      },
      properties: {
        title: "Magic Gardens",
        address:"1020 South Street",
        "marker-size": "large"
      }
    }
  ]
};

var dance = {
  type: "FeatureCollection",
  category: "dance",
  name: "Places to Dance",
  color: "rgb(101, 45, 145)",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1342204, 39.965554]
      },
      properties: {
        title: "The Barbary",
        category: "Places to Dance",
        address:"951 Frankford Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.143928, 39.949562]
      },
      properties: {
        title: "Cuba Libre",
        address:"10 S 2nd Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1413695,39.9620625]
      },
      properties: {
        title: "The 700",
        address:"700 N 2nd Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1679449,39.9532921]
      },
      properties: {
        title: "Concourse",
        address:"1635 Market Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1631093, 39.9484988]
      },
      properties: {
        title: "Franky Bradley's",
        address:"1320 Chancellor Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1356343,39.9701736]
      },
      properties: {
        title: "Liason Room",
        address:"1253 North Front Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1696093, 39.9505841]
      },
      properties: {
        title: "Raven Lounge",
        address:"1718 Samson Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1389126,39.9550325]
      },
      properties: {
        title: "Morgan's Pier",
        address:"221 N Christopher Columbus Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1680133,39.9305848]
      },
      properties: {
        title: "Dolphin Tavern",
        address:"1539 S Broad Street",
        "marker-size": "large"
      }
    }
  ]
};

var novelties = {
  type: "FeatureCollection",
  category: "novelties",
  name: "Oddities",
  color: "rgb(242, 169, 60)",
  features: [
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1766375, 39.9532011]
      },
      properties: {
        title: "Mutter Museum",
        category: "Oddities",
        address:"19 S 22nd Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.0263862, 40.0425662]
      },
      properties: {
        title: "Insectarium",
        address:"8046 Frankford Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.153398,39.9547319]
      },
      properties: {
        title: "Temple School of Podiatric Medicine Museum of Shoes",
        address:"148 N 8th Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.153113,39.9413162]
      },
      properties: {
        title: "Anastacia's Antiques",
        address:"617 Bainbridge Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.163846, 39.945555]
      },
      properties: {
        title: "Henri David's Halloween",
        address:"1329 Pine Street",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1280973,39.9806765]
      },
      properties: {
        title: "Pizza Brain",
        address:"2313 Frankford Avenue",
        "marker-size": "large"
      }
    },
    {
      type: "Feature",
      geometry: {
        type: "Point",
        coordinates: [-75.1487818, 39.9419396]
      },
      properties: {
        title: "The Strange and the Unusual",
        address:"523 S 4th Street",
        "marker-size": "large"
      }
    }
  ]
};

const categories = [filmTV, liveTheater, musicVenues, performanceVenues, interactiveExperiences, arts, dance, novelties];
const dataArray = [...filmTV.features, ...liveTheater.features, ...musicVenues.features,
                   ...performanceVenues.features, ...interactiveExperiences.features,
                   ...arts.features, ...dance.features, ...novelties.features];
const popups = [];

mapboxgl.accessToken = 'pk.eyJ1IjoiZHB3ZWJkZXYiLCJhIjoiY2pmYmN2dDB4MWNoYjRlcTdjM2Y3bGpzZyJ9.1m44PhD4VmqEhKhI4FhPKA';
const map = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/dpwebdev/cjfbcjxzi69w52rk936tb9lyu',
  center: [-75.1850894,39.9522277],
  zoom: 12,
  scrollZoom: false
});

map.addControl(new mapboxgl.NavigationControl());

// populate map with separate data and layers for each category
map.on('load', () => {
  categories.forEach((category) => {
    const name = category.category;
    map.addSource(name, {
      type: 'geojson',
      data: category
    });

    map.addLayer({
      "id": name,
      "type": "circle",
      "paint": {
        "circle-color": category.color
      },
      "source": name
    });

    // add listeners for popups when clicking on point
    map.on('click', name, (e) => {
      const coordinates = e.features[0].geometry.coordinates.slice();
      const prop = e.features[0].properties;
      const text = `<h4>${prop.title}</h4><p class="address">${prop.address}</p>`;

      popups.push(new mapboxgl.Popup().setLngLat(coordinates).setHTML(text).addTo(map));
    });

    // change the cursor to a pointer when the mouse is over the current layer
    map.on('mouseenter', name, () => {
      map.getCanvas().style.cursor = 'pointer';
    });

    // change it back to a pointer when it leaves.
    map.on('mouseleave', name, () => {
      map.getCanvas().style.cursor = '';
    });
  });
});

// create listings and add listing click listeners
let categoryClass;
for (let i in dataArray) {
  const feature = dataArray[i];
  const prop = feature.properties;

  // if this is the first feature for this category, add the header
  if (prop.category) {
    categoryClass = prop.category.toLowerCase().split(' ')[0];
    const category = listings.appendChild(document.createElement('div'));
    category.className = `category ${categoryClass}`;
    category.innerHTML = `<h3>${prop.category}</h3>`;
  }

  const listing = listings.appendChild(document.createElement('div'));
  listing.className = `item ${categoryClass}`;
  listing.position = i;

  const title = listing.appendChild(document.createElement('h4'));
  title.className = 'title';
  title.innerHTML = prop.title;

  const details = listing.appendChild(document.createElement('div'));
  details.innerHTML = `<p class="address">${prop.address}</p>`;

  listing.addEventListener('click', function(e) {
    const curr = dataArray[this.position];
    const prop = curr.properties;
    const text = `<h4>${prop.title}</h4><p class="address">${prop.address}</p>`;
    const coordinates = curr.geometry.coordinates;

    // clear popups so we only have one on the map at once
    popups.forEach((el) => {
      el.remove();
    });

    map.setCenter(coordinates, 16);
    popups.push(new mapboxgl.Popup().setLngLat(coordinates).setHTML(text).addTo(map));
  });
}
